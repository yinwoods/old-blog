<!DOCTYPE html>
<html lang="cn">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<link rel="dns-prefetch" href="//hm.baidu.com"/>
	<link rel="dns-prefetch" href="//disqus.com"/>
	<link rel="dns-prefetch" href="//a.disquscdn.com"/>

	<meta name="Keywords" content="yinwoods,殷成涛,个人博客,郑州大学,php,mysql"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/>
	<meta content="yes" name="apple-mobile-web-app-capable" />
	<meta content="black" name="apple-mobile-web-app-status-bar-style" />
	<meta content="telephone=no" name="format-detection" />
	
	<meta name="author" content="yinwoods">

	<link rel="alternate" type="application/rss+xml" title="rss订阅" href="/feed.xml">
	<link rel="shortcut icon" href="/static/img/icon-16.png" sizes="16x16" />
	<link rel="apple-touch-icon-precomposed" href="/static/img/icon-16.png" sizes="16x16" />
	<link rel="apple-touch-icon-precomposed" href="/static/img/icon-24.png" sizes="24x24" />
	<link rel="apple-touch-icon-precomposed" href="/static/img/icon-32.png" sizes="32x32" />
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/prism.css">

    <title>php + mysql 实现分页 | yinwoods</title>
  
	<link rel="stylesheet" href="/static/css/style.css">
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
	<script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
		(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
		e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
		})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

		_st('install','csxq-8xzb6tiaQ1dQaGs','2.0.0');
	</script>
</head>


<body>
	<div id="container" class="container">
		<div id="content" class="content">
			<nav class="navbar">
	<div class="pull-left">
		<button id="btnMenu" type="button" class="btn btn-default btn-sm btn-menu">
			<i class="fa fa-bars"></i>	菜 单
		</button>
	</div>
	<ul class="pull-center">
		<li class="active"><a href="/">博客</a></li>
        <li><a href="/category/aboutme.html">关于我</a></li>
	</ul>
	<div class="pull-right">
		<button type="button" class="btn btn-default btn-sm btn-list">
			<a href="/category/books.html">
				<i class="fa fa-book fa-fw"></i>书单/影单  
			</a>
		</button>
	</div>
</nav>

			<header class="post-header">
        <div class="hd-img">
            <img src="http://7xlh6u.com1.z0.glb.clouddn.com/bg7.jpg" alt="背景图片">
        </div>

        <div class="title">
           <h1>php + mysql 实现分页</h1>
        </div>
</header>
<button id="btnArrow" class="btn-arrow" data-info="点击显示文章"><i class="icon icon-arrow-down">&#xe619;</i></button>
<div class="post-title">
	<h1>php + mysql 实现分页</h1>
	
    <p>作者: <a target="_blank" href="http://blog.yinwoods.com/"><strong>yinwoods</strong></a>&nbsp;&nbsp;&nbsp;
        分类: <a target="_blank" href="http://blog.yinwoods.com/coding.html"><strong>coding</strong></a>&nbsp;&nbsp;&nbsp;
        日期: <strong>2015年07月11日</strong>&nbsp;&nbsp;&nbsp;
         <ul class="tags post-tags">
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
                    <li><a href="/tags/php/index.html">php<span>3</span></a></li>
                
            
                
            
            
            
                
            
                
                    <li><a href="/tags/mysql/index.html">mysql<span>2</span></a></li>
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
            
                
            
                
            
            
        </ul>
    </p>           
</div>
    

    <article class="post-content">
        <hr class="post-end-left"><p class="post-end">开始</p><hr class="post-end-right"/>
        <div>
            <h5 id="java-eephpmysql">早在做java EE项目的时候就意识到分页并不容易做，甚至项目有了分页功能就有了一个很大的卖点，通过今天下午的学习，理解并掌握了运用php+mysql实现分页的方法</h5>

<p>先附上分页效果:</p>

<p><img src="http://7xlnl2.com1.z0.glb.clouddn.com/post7-分页.png" alt="分页效果" /></p>

<p>首先要明确的一点是分页功能的实现主要借助于mysql的select limit语句；</p>

<p>这里的limit的功能就在于限定显示的记录数</p>

<p>如果limit后跟一个数x即限定显示的记录数，若跟两个数x,y 则x表示开始的记录数,y表示记录的个数</p>

<p>因此我们可以限定每页显示的记录数，然后设定一个参数p代表页数</p>

<p>我们用p来传递当前页面数值，从而实现分页功能</p>

<p>接下来就很简单了，制作按钮，当然这里有些细节要注意，例如</p>

<blockquote>
  <p>1、跳转到首页后，不能再选择跳转到上一页</p>
</blockquote>

<blockquote>
  <p>2、页面过多时显示的页码数要随之而改变</p>
</blockquote>

<p>下面直接附上代码及注释希望对有需要的朋友有所帮助</p>

<div>
  <pre><code class="html">&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
    &lt;style&gt;
        body {
            font-size: 16px; font-family:verdana; width:100%;
        }
        div.page {
            text-align:center;
        }
        div.content {
            height: 300px;
        }
        div.page a{
            border:#aaaadd 1px solid; text-decoration:none; padding: 2px 5px 2px 5px; margin:2px;
        }
        div.page span.current {
            border:#0000099 1px solid; background-color:#000099; padding:4px 6px 4px 6px; margin:2px; color:#fff; font-weight:bold;
        }
        div.page span.disable {
            border:#eee 1px solid; padding:2px 5px 2px 5px; margin:2px; color:#ddd;
        }
        div.page form {
            display:inline;
        }
    &lt;/style&gt;
&lt;/head&gt;</code></pre>
</div>

<div>
  <pre><code class="php">&lt;body&gt;
&lt;?php
    //echo &quot;&lt;pre&gt;&quot;;
    //print_r($_SERVER);

    $page = $_GET['p']; //page代表当前页面数
    $host = &quot;localhost&quot;;
    $username = &quot;root&quot;;
    $password = &quot;root&quot;;
    $db = &quot;test&quot;;
    $pageSize = 10; //每页显示的记录数
    $showPage = 5; //要显示的页码数
    
    echo &quot;&lt;h1 align='center'&gt;分页显示结果&lt;/h1&gt;&lt;br/&gt;&quot;;

    //建立mysql连接
    $conn = mysql_connect($host, $username, $password);
    if(!$conn) {
        echo &quot;failed connect&quot;;
        exit;
    }

    //选择数据库以及设置编码
    mysql_select_db($db);
    mysql_query(&quot;SET NAME UTF8&quot;);

    //向数据库中添加数据
    /*
    for($i=2; $i&lt;1000; ++$i) {
        $name = &quot;'name&quot;.$i.&quot;'&quot;;
        $sql = &quot;insert into page values (&quot; .$i.&quot;, &quot;.$name.&quot;)&quot;;
        $result = mysql_query($sql);
    }
     */

    //限定从10的整数倍记录开始（如第0、10、20...条），并每页显示10条记录
    $sql = &quot;select * from page limit &quot;.($pageSize*($page-1)).&quot;, &quot;.$pageSize;
    $result = mysql_query($sql);

    //输出从数据库读取的结果
    echo &quot;&lt;div class='content'&gt;&quot;;
    echo '&lt;table align=&quot;center&quot; border=1 cellspacing=0 width=40%&gt;';
    echo &quot;&lt;tr&gt;&lt;td align='center'&gt;ID&lt;/td&gt;&lt;td align='center'&gt;NAME&lt;/td&gt;&lt;/tr&gt;&quot;;
    while($row = mysql_fetch_assoc($result)) {
        echo '&lt;tr&gt;';
        echo &quot;&lt;td align='center'&gt;{$row['id']}&lt;/td&gt;&quot;;
        echo &quot;&lt;td align='center'&gt;{$row['name']}&lt;/td&gt;&quot;;
        echo &quot;&lt;/tr&gt;&quot;;
    }
    echo '&lt;/table&gt;';
    echo '&lt;/div&gt;'; 
    
    //num_sql : 总记录
    //num_result : 总记录
    //num : 按每页pageSize条记录显示可分num页
    $num_sql = 'select count(*) from page';
    $num_result = mysql_fetch_array(mysql_query($num_sql));
    $num = $num_result[0];
    $num = ceil($num/$pageSize); //页数需要向上取整，保证最后一页可以显示少于10条的记录

    //释放并关闭连接
    mysql_free_result($result);
    mysql_close($conn);

    $page_banner = &quot;&lt;div class='page'&gt;&quot;;

    //计算左右两侧偏移量
    $pageOffset = ($showPage - 1) / 2; 

    //当前停留在第一页时隐藏首页以及上一页按钮
    if($page &gt; 1) {
        $page_banner .= &quot;&lt;a href='&quot;.$_SERVER['PHP_SELF'].&quot;?p=1'&gt;首页&lt;/a&gt;&quot;;
        $page_banner .= &quot;&lt;a href='&quot;.$_SERVER['PHP_SELF'].&quot;?p=&quot;.($page-1).&quot;'&gt;&lt;上一页&lt;/a&gt;&quot;;
    } else {
        $page_banner .= &quot;&lt;span class='disable'&gt;首页&lt;/a&gt;&lt;/span&gt;&quot;;
        $page_banner .= &quot;&lt;span class='disable'&gt;上一页&lt;/a&gt;&lt;/span&gt;&quot;;
    }

    //设置页面显示的左侧以及右侧
    $start = 1;
    $end = $num;
    if($num &gt; $showPage) {
        if($page &gt; $pageOffset+1) { //从pageOffset+2开始左侧要显示...
            $page_banner .= '...';
        }
        if($page &gt; $pageOffset) {//设定要显示的页码范围
            $start = $page-$pageOffset;
            $end = $num &gt; $page+$pageOffset ? $page+$pageOffset : $num;
        } else {
            $start = 1;
            $end = $num &gt; $showPage ? $showPage : $num;
        }
        //确保显示合理页数
        if($page + $pageOffset &gt; $num) {
            $start = $start - ($page + $pageOffset - $end);
        }
    }


    //对当前页面页码做高亮处理
    for($i=$start; $i&lt;=$end; ++$i) {
        if($page == $i) {
            $page_banner .= &quot;&lt;span class='current' &gt;{$i}&lt;/span&gt;&quot;;
        } else {
            //为各个页码设置对应的超链接
            $page_banner .= &quot;&lt;a href='&quot;.$_SERVER['PHP_SELF'].&quot;?p=&quot;.($i).&quot;'&gt;&quot;.$i.&quot;&lt;/a&gt;&quot;;
        }
    }

    if($num &gt; $showPage &amp;&amp; $num &gt; $page+$pageOffset) {
        $page_banner .= &quot;...&quot;;
    }

    if($page &lt; $num) {
        $page_banner .= &quot;&lt;a href='&quot;.$_SERVER['PHP_SELF'].&quot;?p=&quot;.($page+1).&quot;'&gt;下一页&gt;&lt;/a&gt;&quot;;
        $page_banner .= &quot;&lt;a href='&quot;.$_SERVER['PHP_SELF'].&quot;?p=&quot;.($num).&quot;'&gt;尾页&lt;/a&gt;&quot;;
    } else {
        $page_banner .= &quot;&lt;span class='disable'&gt;下一页&lt;/a&gt;&lt;/span&gt;&quot;;
        $page_banner .= &quot;&lt;span class='disable'&gt;尾页&lt;/a&gt;&lt;/span&gt;&quot;;
    }

    echo $page_banner;
    echo &quot;共{$num}页&quot;;

    //设置页面跳转,把输入的变量值传递给p即可
    $page_banner = &quot;&lt;form action='mypage.php' method='get'&gt;&quot;;
    $page_banner .= &quot;到第&lt;input type='text' size='2' name='p'&gt;&quot;;
    $page_banner .= &quot;&lt;input type='submit' value='确定'&gt;&quot;;
    $page_banner .= &quot;&lt;/form&gt;&lt;/div&gt;&quot;;
    echo $page_banner;

?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>


        </div>
        <hr class="post-end-left"><p class="post-end">结束</p><hr class="post-end-right"/>
        <div class="post-footer">
            
            <p class="post-footer-previous">上一篇 ： <a class="entry-more" href="/myshare/%E8%A7%A3%E5%86%B3ubuntu%E4%B8%8D%E8%83%BD%E8%AE%BF%E9%97%AEwindows%E7%A3%81%E7%9B%98%E9%97%AE%E9%A2%98.html">解决ubuntu不能访问windows磁盘问题</a></p>
            
            
            <p class="post-footer-next">下一篇 ： <a class="entry-more" href="/coding/php%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html">php学习笔记</a></p>
            
        </div>
    <!-- JiaThis Button BEGIN -->
    <div class="jiathis_style">
        <span style="font-family:sans-serif; color:#009966">分享到：</span>
        <a class="jiathis_button_weixin share_button" href="#"></a>
        <a class="jiathis_button_tsina share_button" href="#"></a>
        <a class="jiathis_button_qzone share_button" href="#"></a>
        <a class="jiathis_button_evernote share_button" href="#"></a>
        <a class="jiathis_button_ydnote share_button" href="#"></a>
        <a class="jiathis_button_pocket share_button" href="#"></a>
        <a class="jiathis_button_douban share_button" href="#"></a>
        <a class="jiathis_button_renren share_button" href="#"></a>
        <a class="jiathis_button_fb share_button" href="#"></a>
        <a class="jiathis_button_linkedin share_button" href="#"></a>
        <a class="jiathis_button_googleplus share_button" href="#"></a>
        <a class="jiathis_button_tumblr share_button" href="#"></a>
        <a class="jiathis_counter_style"></a>
    </div>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/totop.js" charset="utf-8"></script>
<!-- JiaThis Button END -->
<script type="text/javascript" src="/static/js/prism.js" charset="utf-8"></script>
</article>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'yinwoods'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    



		</div>

				<nav id="menu" class="menu">
			<ul>
				<li class="logo"><a href="/category/aboutme.html"><img  class="img-circle" height="100px" width="100px" src="/static/img/about/me.jpg"></a></li>

				<li><a href="/category/index.html"><i class="fa fa-home fa-fw"></i>首页</a></li>
				
				<li><a href="/category/coding.html"><i class="fa fa-road fa-fw"></i>编程之路</a></li>

				<li><a href="/category/myshare.html"><i class="fa fa-share-alt fa-fw"></i>我的分享</a></li>
				
				<li><a href="/category/diary.html"><i class="fa fa-calculator fa-fw"></i>生活日志</a></li>
				
				<li><a href="/category/book-movie-list/booklist.html"><i class="fa fa-book fa-fw"></i>书单/影单</a></li>

				<li><a href="/category/aboutme.html"><i class="fa fa-male fa-fw"></i>关于博主</a></li>

				<li><a href="/category/friend.html"><i class="fa fa-send fa-fw"></i>我的朋友</a></li>

				<li><img class="img-rounded" height="100px" width="100%" src="/static/img/about/footer.png"></li>

			</ul>
			<button id="btnClose" class="btn-close"></button>

			<div id="SVGMenu" class="svg-menu" 
                data-menu-open="M-7.312,0H15c0,0,66,113.339,66,399.5C81,664.006,15,800,15,800H-7.312V0z;M-7.312,0H100c0,0,0,113.839,0,400c0,264.506,0,400,0,400H-7.312V0z" 
                data-menu-close="M-6,0h101c0,0-90,153.603-90,396.167C2.167,627.579,100,800,100,800H-1V0z;M-7.312,0H100c0,0,0,113.839,0,400c0,264.506,0,400,0,400H-7.312V0z">
				<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 100 800" preserveAspectRatio="none">
					<path d="M-7.312,0H0c0,0,0,113.839,0,400c0,264.506,0,400,0,400h-7.312V0z"/>
				</svg>
			</div>

		</nav>


		<footer class="footer">
	<div class="row">
		<div class="pull-left">
			<a class="avatar" href="/" title="yinwoods">yinwoods</a>
			<p class="copyright">2015 ALL RIGHTS RESERVED</p>
		</div>
		
		<div class="pull-center">
			<ul class="list-inline">
				<li>
					<a href="http://weibo.com/yinwoods">
						<img src="/static/img/footer/weibo.png">
					</a>
				</li>
				<li>
					<a href="https://github.com/yinwoods">
						<img src="/static/img/footer/github.png">
					</a>
				</li>
				<li>
					<a href="/feed.xml">
						<img src="/static/img/footer/rss.png">
					</a>
				</li>
			</ul>
			<br/>
			<h4>Powered by <a target="_blank" href="https://github.com/yinwoods">github</a> && <a target="_blank" href="http://jekyllrb.com/">jekyll</a></h4>
		</div>

	</div>
</footer>
		<div id="totop">
			<a title="返回顶部">返回顶部</a>
		</div>
	</div>

	<script type="text/javascript" src="/static/js/classie.js"></script>

	<script type="text/javascript" src="/static/js/snap.svg-min.js"></script>
	<script type="text/javascript" src="/static/js/menuTriggle.js"></script>
	<script type="text/javascript" src="/static/js/SVGButton.js"></script>

	<script type="text/javascript" src="/static/js/postTriggle.js"></script>

	
	<script type="text/javascript" src="/static/js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="/static/js/totop.js"></script>
	<script type="text/javascript">
		var content = document.querySelector('.content'),
			footer = document.querySelector('.footer'),
			footT  = footer.offsetTop,
			footH  = footer.offsetHeight,
			winH   = window.innerHeight,
			post   = document.querySelectorAll('p');

		if (footT - footH + 100 < winH) {
			content.style.height = '100%';
		};

		for (var i = 0; i < post.length; i++) {
			if (post.item(i).querySelector('img')) {
				post.item(i).style.textIndent = 0;
			};
		};

	</script>
</body>
</html>
